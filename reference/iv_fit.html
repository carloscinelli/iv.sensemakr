<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Instrumental Variable Estimation using the Anderson-Rubin approach — iv_fit • iv.sensemakr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Instrumental Variable Estimation using the Anderson-Rubin approach — iv_fit"><meta name="description" content="iv_fit computes instrumental variable estimates and confidence intervals using the Anderson-Rubin (AR) approach (Anderson and Rubin, 1949).  This approach is numerically identical to Fieller's theorem (Fieller, 1954). See Cinelli and Hazlett (2025) for further discussion.
The AR point estimate is numerically identical to the point estimate of two-stage least squares (2SLS) and it is given by the ratio of the reduced-form to the first-stage regression coefficient. Confidence intervals, however, are constructed differently. 2SLS is equivalent to using the delta-method to obtain the variance of the ratio estimator, and then proceeding by assuming the ratio is asymptotically normal. This approximation can fail when instruments are &quot;weak.&quot; The Anderson-Rubin approach instead uses a test inversion procedure to construct confidence intervals. This procedure has correct coverage regardless of instrument strength, at the (inevitable) cost of eventually obtaining unbounded confidence intervals."><meta property="og:description" content="iv_fit computes instrumental variable estimates and confidence intervals using the Anderson-Rubin (AR) approach (Anderson and Rubin, 1949).  This approach is numerically identical to Fieller's theorem (Fieller, 1954). See Cinelli and Hazlett (2025) for further discussion.
The AR point estimate is numerically identical to the point estimate of two-stage least squares (2SLS) and it is given by the ratio of the reduced-form to the first-stage regression coefficient. Confidence intervals, however, are constructed differently. 2SLS is equivalent to using the delta-method to obtain the variance of the ratio estimator, and then proceeding by assuming the ratio is asymptotically normal. This approximation can fail when instruments are &quot;weak.&quot; The Anderson-Rubin approach instead uses a test inversion procedure to construct confidence intervals. This procedure has correct coverage regardless of instrument strength, at the (inevitable) cost of eventually obtaining unbounded confidence intervals."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">iv.sensemakr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/iv.sensemakr.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/carloscinelli/iv.sensemakr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Instrumental Variable Estimation using the Anderson-Rubin approach</h1>
      <small class="dont-index">Source: <a href="https://github.com/carloscinelli/iv.sensemakr/blob/main/R/iv_functions.R" class="external-link"><code>R/iv_functions.R</code></a></small>
      <div class="d-none name"><code>iv_fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>iv_fit</code> computes instrumental variable estimates and confidence intervals using the Anderson-Rubin (AR) approach (Anderson and Rubin, 1949).  This approach is numerically identical to Fieller's theorem (Fieller, 1954). See Cinelli and Hazlett (2025) for further discussion.</p>
<p>The AR point estimate is numerically identical to the point estimate of two-stage least squares (2SLS) and it is given by the ratio of the reduced-form to the first-stage regression coefficient. Confidence intervals, however, are constructed differently. 2SLS is equivalent to using the delta-method to obtain the variance of the ratio estimator, and then proceeding by assuming the ratio is asymptotically normal. This approximation can fail when instruments are "weak." The Anderson-Rubin approach instead uses a test inversion procedure to construct confidence intervals. This procedure has correct coverage regardless of instrument strength, at the (inevitable) cost of eventually obtaining unbounded confidence intervals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">iv_fit</span><span class="op">(</span><span class="va">y</span>, <span class="va">d</span>, <span class="va">z</span>, x <span class="op">=</span> <span class="cn">NULL</span>, h0 <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> <code><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></code> with the outcome.</p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> <code><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></code> with the treatment.</p></dd>


<dt id="arg-z">z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> <code><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></code> with the instrument.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>(optional) <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></code> with observed covariates.</p></dd>


<dt id="arg-h-">h0<a class="anchor" aria-label="anchor" href="#arg-h-"></a></dt>
<dd><p>null hypothesis for the target parameter (the IV estimate).</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>significance test for hypothesis tests and confidence intervals.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>iv_fit</code>, containing:</p><dl><dt> <code>data</code> </dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> with the data used for fitting the models.</p></dd>

 <dt> <code>models</code> </dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> with the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> models used for obtaining the IV estimates. This includes the first-stage (FS), reduced-form (RF), and Anderson-Rubin (AR) regressions.</p></dd>

 <dt> <code>estimates</code> </dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> with the summary information of IV estimates, as well as summary information of the auxiliary estimates of the FS, RF, and AR regression.</p></dd>

 <dt><code>pars</code></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> with the parameters of the call, such as the null hypothesis <code>h0</code> and the significance level <code>alpha</code>.</p></dd>


</dl><p>@returns
 The function returns an object of class <code>iv_fit</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Anderson, T.W. and Rubin, H. (1949), Estimation of the parameters of a single equation in a complete system of stochastic equations, Annals of Mathematical Statistics, 20, 46-63.</p>
<p>Fieller, E. C. (1954). Some problems in interval estimation. Journal of the Royal Statistical Society: Series B (Methodological), 16(2), 175-185.</p>
<p>Cinelli, C. and Hazlett, C. (2025), "An Omitted Variable Bias Framework for Sensitivity Analysis of Instrumental Variables." Biometrika. <a href="https://doi.org/10.1093/biomet/asaf004" class="external-link">doi:10.1093/biomet/asaf004</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># prepare data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"card"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">card</span><span class="op">$</span><span class="va">lwage</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">card</span><span class="op">$</span><span class="va">educ</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">card</span><span class="op">$</span><span class="va">nearc4</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">exper</span> <span class="op">+</span> <span class="va">expersq</span> <span class="op">+</span> <span class="va">black</span> <span class="op">+</span> <span class="va">south</span> <span class="op">+</span> <span class="va">smsa</span> <span class="op">+</span> <span class="va">reg661</span> <span class="op">+</span> <span class="va">reg662</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                     <span class="va">reg663</span> <span class="op">+</span> <span class="va">reg664</span> <span class="op">+</span> <span class="va">reg665</span><span class="op">+</span> <span class="va">reg666</span> <span class="op">+</span> <span class="va">reg667</span> <span class="op">+</span> <span class="va">reg668</span> <span class="op">+</span> <span class="va">smsa66</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">card</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit iv model</span></span></span>
<span class="r-in"><span><span class="va">card.fit</span> <span class="op">&lt;-</span> <span class="fu">iv_fit</span><span class="op">(</span><span class="va">y</span>, <span class="va">d</span>, <span class="va">z</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">card.fit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Instrumental Variable Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Anderson-Rubin Approach)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =============================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IV Estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Coef. Estimate: 0.132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   t-value: 2.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   p-value: 0.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Conf. Interval: [0.025, 0.285]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Note: H0 = 0, alpha = 0.05, df = 2994.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =============================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> See summary for first stage and reduced form.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">card.fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Instrumental Variable Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Anderson-Rubin Approach)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =============================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IV Estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Coef. Estimate: 0.132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   t-value: 2.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   p-value: 0.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Conf. Interval: [0.025, 0.285]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Note: H0 = 0, alpha = 0.05, df = 2994.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FS Estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Coef. Estimate: 0.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Error: 0.0879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   t-value: 3.64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   p-value: 0.000276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Conf. Interval: [0.148, 0.492]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Note: H0 = 0, alpha = 0.05, df = 2994.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RF Estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Coef. Estimate: 0.0421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Error: 0.0181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   t-value: 2.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   p-value: 0.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Conf. Interval: [0.007, 0.078]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Note: H0 = 0, alpha = 0.05, df = 2994.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =============================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://carloscinelli.com" class="external-link">Carlos Cinelli</a>, <a href="https://www.chadhazlett.com" class="external-link">Chad Hazlett</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

